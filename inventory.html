<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory - South East Pharmacy</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="flex justify-between items-center mb-8">
            <h1 class="text-4xl font-bold">üìã Inventory Management</h1>
            <a href="home.html" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded-lg transition-colors">‚Üê Back</a>
        </div>

        <div class="grid md:grid-cols-3 gap-6 mb-8">
            <div class="bg-gray-800 rounded-lg p-6 text-center">
                <div class="text-3xl font-bold text-green-400 mb-2">1,247</div>
                <div class="text-gray-400">Total Items</div>
            </div>
            <div class="bg-gray-800 rounded-lg p-6 text-center">
                <div class="text-3xl font-bold text-yellow-400 mb-2">23</div>
                <div class="text-gray-400">Low Stock</div>
            </div>
            <div class="bg-gray-800 rounded-lg p-6 text-center">
                <div class="text-3xl font-bold text-red-400 mb-2">5</div>
                <div class="text-gray-400">Out of Stock</div>
            </div>
        </div>

        <div class="bg-gray-800 rounded-lg p-6 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">Inventory Items</h3>
                <button onclick="showAddItemModal()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded transition-colors">Add New Item</button>
            </div>
            
            <div class="mb-4">
                <input type="text" id="searchItems" placeholder="Search items..." class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white" onkeyup="filterItems()">
            </div>

            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b border-gray-700">
                            <th class="text-left py-3">Item Name</th>
                            <th class="text-left py-3">Category</th>
                            <th class="text-left py-3">Stock</th>
                            <th class="text-left py-3">Unit Price</th>
                            <th class="text-left py-3">Status</th>
                            <th class="text-left py-3">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                    <tbody id="inventoryTableBody">
                        <!-- Items will be populated dynamically -->
                    </tbody>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Add/Edit Item Modal -->
        <div id="itemModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-gray-800 rounded-lg p-8 max-w-md w-full mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold" id="itemModalTitle">Add New Item</h2>
                    <button onclick="closeItemModal()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
                </div>
                
                <form id="itemForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Item Name:</label>
                        <input type="text" id="itemName" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Category:</label>
                        <select id="itemCategory" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white">
                            <option value="Tablets">Tablets</option>
                            <option value="Antibiotics">Antibiotics</option>
                            <option value="Supplements">Supplements</option>
                            <option value="Equipment">Equipment</option>
                            <option value="Diabetes">Diabetes</option>
                            <option value="Pain Relief">Pain Relief</option>
                            <option value="Vitamins">Vitamins</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Stock Quantity:</label>
                        <input type="number" id="itemStock" min="0" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Unit Price ($):</label>
                        <input type="number" id="itemPrice" step="0.01" min="0" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Low Stock Alert (minimum quantity):</label>
                        <input type="number" id="itemMinStock" min="0" value="10" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Supplier:</label>
                        <input type="text" id="itemSupplier" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white">
                    </div>
                    <div class="flex gap-4">
                        <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 py-3 rounded font-semibold transition-colors">Save</button>
                        <button type="button" onclick="closeItemModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 py-3 rounded font-semibold transition-colors">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        let inventoryData = [
            { id: 'ITM001', name: 'Paracetamol 500mg', category: 'Tablets', stock: 150, price: 0.50, minStock: 20, supplier: 'PharmaCorp' },
            { id: 'ITM002', name: 'Amoxicillin 250mg', category: 'Antibiotics', stock: 25, price: 1.20, minStock: 30, supplier: 'MediSupply' },
            { id: 'ITM003', name: 'Insulin Pen', category: 'Diabetes', stock: 0, price: 15.00, minStock: 5, supplier: 'DiabetesCare' },
            { id: 'ITM004', name: 'Vitamin D3', category: 'Supplements', stock: 75, price: 2.30, minStock: 25, supplier: 'VitaHealth' },
            { id: 'ITM005', name: 'Blood Pressure Monitor', category: 'Equipment', stock: 12, price: 45.00, minStock: 15, supplier: 'MedEquip' }
        ];

        let editingIndex = -1;

        function renderInventory() {
            const tbody = document.getElementById('inventoryTableBody');
            tbody.innerHTML = '';

            inventoryData.forEach((item, index) => {
                const status = getStockStatus(item.stock, item.minStock);
                const statusClass = getStatusClass(status);
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-700';
                row.innerHTML = `
                    <td class="py-3">${item.name}</td>
                    <td class="py-3">${item.category}</td>
                    <td class="py-3">${item.stock}</td>
                    <td class="py-3">$${item.price.toFixed(2)}</td>
                    <td class="py-3"><span class="${statusClass} px-2 py-1 rounded text-xs">${status}</span></td>
                    <td class="py-3">
                        <button onclick="editItem(${index})" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs mr-1">Edit</button>
                        <button onclick="deleteItem(${index})" class="bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs mr-1">Delete</button>
                        <button onclick="adjustStock(${index})" class="bg-yellow-600 hover:bg-yellow-700 px-2 py-1 rounded text-xs">Adjust</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            updateInventoryStats();
        }

        function getStockStatus(stock, minStock) {
            if (stock === 0) return 'Out of Stock';
            if (stock <= minStock) return 'Low Stock';
            return 'In Stock';
        }

        function getStatusClass(status) {
            switch(status) {
                case 'In Stock': return 'bg-green-600';
                case 'Low Stock': return 'bg-yellow-600';
                case 'Out of Stock': return 'bg-red-600';
                default: return 'bg-gray-600';
            }
        }

        function updateInventoryStats() {
            const totalItems = inventoryData.length;
            const lowStock = inventoryData.filter(item => item.stock > 0 && item.stock <= item.minStock).length;
            const outOfStock = inventoryData.filter(item => item.stock === 0).length;

            document.querySelector('.grid .bg-gray-800:nth-child(1) .text-3xl').textContent = totalItems;
            document.querySelector('.grid .bg-gray-800:nth-child(2) .text-3xl').textContent = lowStock;
            document.querySelector('.grid .bg-gray-800:nth-child(3) .text-3xl').textContent = outOfStock;
        }

        function showAddItemModal() {
            editingIndex = -1;
            document.getElementById('itemModalTitle').textContent = 'Add New Item';
            document.getElementById('itemForm').reset();
            document.getElementById('itemMinStock').value = '10';
            document.getElementById('itemModal').classList.remove('hidden');
            document.getElementById('itemModal').classList.add('flex');
        }

        function editItem(index) {
            editingIndex = index;
            const item = inventoryData[index];
            document.getElementById('itemModalTitle').textContent = 'Edit Item';
            document.getElementById('itemName').value = item.name;
            document.getElementById('itemCategory').value = item.category;
            document.getElementById('itemStock').value = item.stock;
            document.getElementById('itemPrice').value = item.price;
            document.getElementById('itemMinStock').value = item.minStock;
            document.getElementById('itemSupplier').value = item.supplier || '';
            document.getElementById('itemModal').classList.remove('hidden');
            document.getElementById('itemModal').classList.add('flex');
        }

        function deleteItem(index) {
            if (confirm('Are you sure you want to delete this item?')) {
                inventoryData.splice(index, 1);
                saveInventoryData();
                renderInventory();
            }
        }

        function adjustStock(index) {
            const item = inventoryData[index];
            const adjustment = prompt(`Current stock: ${item.stock}\nEnter adjustment (+/- number):`);
            
            if (adjustment !== null) {
                const change = parseInt(adjustment);
                if (!isNaN(change)) {
                    item.stock = Math.max(0, item.stock + change);
                    saveInventoryData();
                    renderInventory();
                    alert(`Stock adjusted. New quantity: ${item.stock}`);
                }
            }
        }

        function closeItemModal() {
            document.getElementById('itemModal').classList.add('hidden');
            document.getElementById('itemModal').classList.remove('flex');
        }

        function filterItems() {
            const search = document.getElementById('searchItems').value.toLowerCase();
            const rows = document.querySelectorAll('#inventoryTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function saveInventoryData() {
            localStorage.setItem('inventoryData', JSON.stringify(inventoryData));
        }

        function loadInventoryData() {
            const saved = localStorage.getItem('inventoryData');
            if (saved) {
                inventoryData = JSON.parse(saved);
            }
        }

        function generateItemId() {
            const maxId = inventoryData.reduce((max, item) => {
                const num = parseInt(item.id.replace('ITM', ''));
                return num > max ? num : max;
            }, 0);
            return `ITM${String(maxId + 1).padStart(3, '0')}`;
        }

        document.getElementById('itemForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const item = {
                id: editingIndex >= 0 ? inventoryData[editingIndex].id : generateItemId(),
                name: document.getElementById('itemName').value,
                category: document.getElementById('itemCategory').value,
                stock: parseInt(document.getElementById('itemStock').value),
                price: parseFloat(document.getElementById('itemPrice').value),
                minStock: parseInt(document.getElementById('itemMinStock').value),
                supplier: document.getElementById('itemSupplier').value
            };

            if (editingIndex >= 0) {
                inventoryData[editingIndex] = item;
            } else {
                inventoryData.push(item);
            }

            saveInventoryData();
            renderInventory();
            closeItemModal();
        });

        // Initialize
        loadInventoryData();
        renderInventory();
    </script>
</body>
</html>